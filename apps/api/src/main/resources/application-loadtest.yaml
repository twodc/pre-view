spring:
  application:
    name: pre-view

  config:
    import: optional:file:.env[.properties]

  # Spring Security OAuth2 설정
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            scope: email, profile

  # Redis 설정
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}

  datasource:
    url: ${MYSQL_URL}
    username: ${MYSQL_USERNAME}
    password: ${MYSQL_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: false
        show_sql: false
    database-platform: org.hibernate.dialect.MySQLDialect

  ai:
    # WireMock 서버로 연결 (부하 테스트용)
    openai:
      api-key: test-api-key
      base-url: http://localhost:9090
      chat:
        options:
          model: llama-3.3-70b-versatile
          temperature: 0.5
          max-tokens: 800

springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
    try-it-out-enabled: true
  api-docs:
    path: /api-docs
  default-produces-media-type: application/json
  default-consumes-media-type: application/json
  use-management-port: false

logging:
  level:
    root: WARN
    com.example.pre_view: INFO
    org.springframework.security: WARN
    org.springframework.web: WARN
    org.hibernate: WARN
    io.lettuce.core: WARN

# JWT 설정
jwt:
  secret: ${JWT_SECRET}
  access-expiration: 900000
  refresh-expiration: 604800000

# 애플리케이션 설정
app:
  oauth2:
    redirect-uri: ${OAUTH2_REDIRECT_URI:http://localhost:3000/oauth/callback}
  cookie:
    secure: ${COOKIE_SECURE:false}
    same-site: ${COOKIE_SAME_SITE:Lax}
    domain: ${COOKIE_DOMAIN:}

resilience4j:
  retry:
    configs:
      default:
        maxAttempts: 1
        waitDuration: 100ms
    instances:
      aiServiceRetry:
        baseConfig: default
  circuitbreaker:
    instances:
      groqApi:
        registerHealthIndicator: true
        slidingWindowType: COUNT_BASED
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 3
